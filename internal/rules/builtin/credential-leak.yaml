id: CRED_001
name: "OpenAI API key"
description: "Detects OpenAI API keys"
severity: CRITICAL
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "sk-[a-zA-Z0-9]{20,}T3BlbkFJ[a-zA-Z0-9]{20,}"
  - type: regex
    value: "sk-proj-[a-zA-Z0-9_-]{40,}"
  - type: regex
    value: "sk-[a-zA-Z0-9]{48}"
examples:
  true_positive:
    - "OPENAI_API_KEY=sk-proj-abc123def456ghi789jkl012mno345pqr678stu901vwx"
  false_positive:
    - "Set your OPENAI_API_KEY=sk-your-key-here"
---
id: CRED_002
name: "AWS access key"
description: "Detects AWS access key IDs"
severity: CRITICAL
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "AKIA[0-9A-Z]{16}"
examples:
  true_positive:
    - "aws_access_key_id = AKIAIOSFODNN7EXAMPLE"
  false_positive:
    - "The format is AKIA followed by 16 characters"
---
id: CRED_003
name: "GitHub personal access token"
description: "Detects GitHub personal access tokens"
severity: CRITICAL
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "ghp_[a-zA-Z0-9]{36}"
  - type: regex
    value: "gho_[a-zA-Z0-9]{36}"
  - type: regex
    value: "ghu_[a-zA-Z0-9]{36}"
  - type: regex
    value: "ghs_[a-zA-Z0-9]{36}"
  - type: regex
    value: "ghr_[a-zA-Z0-9]{36}"
  - type: regex
    value: "github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59}"
examples:
  true_positive:
    - "GITHUB_TOKEN=ghp_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijkl"
  false_positive:
    - "Tokens start with ghp_ prefix"
---
id: CRED_004
name: "Generic API key pattern"
description: "Detects generic API key assignments with real-looking values"
severity: MEDIUM
category: credential-leak
targets: ["*.py", "*.js", "*.ts", "*.go", "*.java", "*.rb", "*.sh", "*.env", "*.yaml", "*.yml", "*.json"]
match_mode: any
patterns:
  - type: regex
    value: "(?i)(api[_-]?key|api[_-]?secret|apikey)\\s*[=:]\\s*[\"']?[a-zA-Z0-9_\\-]{32,}[\"']?"
  - type: regex
    value: "(?i)(access[_-]?token|auth[_-]?token)\\s*[=:]\\s*[\"']?[a-zA-Z0-9_\\-\\.]{32,}[\"']?"
examples:
  true_positive:
    - "API_KEY=abcdef1234567890abcdef1234567890ab"
    - "auth_token: eyJhbGciOiJIUzI1NiJ9.abcdefghijklmnop"
  false_positive:
    - "api_key = os.getenv('API_KEY')"
    - "api_key: your-api-key-here"
    - "API_KEY=sk-your-key-here"
---
id: CRED_005
name: "Private key block"
description: "Detects PEM-encoded private keys"
severity: CRITICAL
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "-----BEGIN\\s+(RSA|DSA|EC|OPENSSH|PGP)?\\s*PRIVATE KEY( BLOCK)?-----"
examples:
  true_positive:
    - "-----BEGIN RSA PRIVATE KEY-----"
    - "-----BEGIN OPENSSH PRIVATE KEY-----"
  false_positive:
    - "Look for files that start with the BEGIN header"
---
id: CRED_006
name: "Database connection string"
description: "Detects database connection strings with credentials"
severity: HIGH
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "(?i)(mongodb|postgres|postgresql|mysql|redis|amqp|mssql)://[a-zA-Z0-9_]+:[a-zA-Z0-9_!@#$%^&*]+@[a-zA-Z0-9]+\\.[a-zA-Z0-9._\\-]+[:/]"
  - type: regex
    value: "(?i)Data Source=.*;.*Password=.+"
examples:
  true_positive:
    - "DATABASE_URL=postgres://admin:secretpass@db.example.com:5432/mydb"
    - "mongodb://root:password123@mongo.example.com/admin"
  false_positive:
    - "postgres://user:password@localhost/dev"
---
id: CRED_007
name: "Hardcoded password"
description: "Detects hardcoded passwords in code"
severity: HIGH
category: credential-leak
targets: ["*.py", "*.js", "*.ts", "*.go", "*.java", "*.rb", "*.sh"]
match_mode: any
patterns:
  - type: regex
    value: "(?i)(password|passwd|pwd)\\s*[=:]\\s*[\"'][^\"'\\s]{8,}[\"']"
  - type: regex
    value: "(?i)(password|passwd|pwd)\\s*=\\s*[\"'][^\"']{8,}[\"']"
examples:
  true_positive:
    - "password = 'supersecret123'"
    - "DB_PASSWORD=\"MyS3cretP@ss\""
  false_positive:
    - "password = os.getenv('DB_PASSWORD')"
    - "password = input('Enter password: ')"
---
id: CRED_008
name: "Slack or Discord webhook"
description: "Detects Slack and Discord webhook URLs"
severity: HIGH
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "https://hooks\\.slack\\.com/services/T[A-Z0-9]+/B[A-Z0-9]+/[a-zA-Z0-9]+"
  - type: regex
    value: "https://(discord|discordapp)\\.com/api/webhooks/[0-9]+/[a-zA-Z0-9_-]+"
examples:
  true_positive:
    - "SLACK_WEBHOOK=https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX"
    - "https://discord.com/api/webhooks/123456789/abcdef"
  false_positive:
    - "Set up Slack webhooks at hooks.slack.com"
---
id: CRED_009
name: "GCP service account key"
description: "Detects Google Cloud Platform service account credentials"
severity: CRITICAL
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "\"type\"\\s*:\\s*\"service_account\""
  - type: regex
    value: "\"private_key\"\\s*:\\s*\"-----BEGIN"
examples:
  true_positive:
    - '{"type": "service_account", "project_id": "my-project"}'
  false_positive:
    - "Account type can be service_account or user"
---
id: CRED_010
name: "JWT token"
description: "Detects JWT tokens"
severity: MEDIUM
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "eyJ[a-zA-Z0-9_-]{10,}\\.eyJ[a-zA-Z0-9_-]{10,}\\.[a-zA-Z0-9_-]{10,}"
examples:
  true_positive:
    - "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIn0.dozjgNryP4J3jVmNHl0w5N_XgL0n3I9PlFUP0THsR8U"
  false_positive:
    - "JWT tokens follow the format: header.payload.signature"
---
id: CRED_011
name: "Credential in shell export"
description: "Detects API keys or tokens exposed in shell export commands"
severity: HIGH
category: credential-leak
targets: ["*.md", "*.txt"]
match_mode: any
patterns:
  - type: regex
    value: "(?i)export\\s+[A-Z_]*(API[_-]?KEY|SECRET|TOKEN|PASSWORD|CREDENTIAL)[A-Z_]*\\s*=\\s*[\"']?(sk-|ghp_|gho_|AKIA|xox[bpas]-|glpat-|pypi-)[a-zA-Z0-9_\\-]{20,}"
  - type: regex
    value: "(?i)export\\s+[A-Z_]*(API[_-]?KEY|SECRET|TOKEN)[A-Z_]*\\s*=\\s*[\"'][a-zA-Z0-9_\\-]{30,}[\"']"
examples:
  true_positive:
    - "export OPENROUTER_API_KEY=\"sk-or-v1-abc123def456ghi789jkl012mno345pqr678\""
    - "export GITHUB_TOKEN=\"ghp_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijkl\""
  false_positive:
    - "export OPENROUTER_API_KEY=\"sk-or-v1-...\""
    - "export API_KEY=\"your-key-here\""
---
id: CRED_012
name: "Stripe API key"
description: "Detects Stripe live and test API keys"
severity: CRITICAL
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "sk_live_[a-zA-Z0-9]{24,}"
  - type: regex
    value: "sk_test_[a-zA-Z0-9]{24,}"
  - type: regex
    value: "pk_live_[a-zA-Z0-9]{24,}"
  - type: regex
    value: "rk_live_[a-zA-Z0-9]{24,}"
examples:
  true_positive:
    - "STRIPE_KEY=pk_live_00000000000000000000fake"
    - "STRIPE_PK=pk_live_aabbccddeeff00112233fake"
  false_positive:
    - "Set your STRIPE_KEY=sk_test_... in .env"
    - "Stripe keys start with sk_live_ prefix"
---
id: CRED_013
name: "Anthropic API key"
description: "Detects Anthropic API keys"
severity: CRITICAL
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "sk-ant-[a-zA-Z0-9_-]{20,}"
examples:
  true_positive:
    - "ANTHROPIC_API_KEY=sk-ant-api03-abc123def456ghi789"
  false_positive:
    - "Set ANTHROPIC_API_KEY=sk-ant-... in your environment"
---
id: CRED_014
name: "SendGrid or Twilio API key"
description: "Detects SendGrid and Twilio API keys"
severity: HIGH
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "SG\\.[a-zA-Z0-9_-]{22,}\\.[a-zA-Z0-9_-]{20,}"
  - type: regex
    value: "SK[a-f0-9]{32}"
examples:
  true_positive:
    - "SENDGRID_API_KEY=SG.fake00key00example00fake.fake00secret00example00val"
    - "TWILIO_AUTH=SK00000000000000000000000000000000"
  false_positive:
    - "SendGrid keys start with SG. prefix"
---
id: CRED_015
name: "CLI credential flags"
description: "Detects command-line flags passing credentials with real-looking values"
severity: MEDIUM
category: credential-leak
targets: ["*.md", "*.txt"]
match_mode: any
patterns:
  - type: regex
    value: "(?i)--(password|passwd|api-key|api_key|secret|token|auth)\\s*[=]\\s*[\"']?[a-zA-Z0-9_!@#$%^&*-]{12,}[\"']?"
examples:
  true_positive:
    - "--password=MyS3cretP@ssw0rd123"
    - "--api-key=abcdef1234567890abcdef12"
  false_positive:
    - "--password=<your-password>"
    - "--api-key=$API_KEY"
    - "--token=${TOKEN}"
---
id: CRED_016
name: "SSH private key in command"
description: "Detects SSH or SCP commands referencing private key files"
severity: MEDIUM
category: credential-leak
targets: ["*.md", "*.txt"]
match_mode: any
patterns:
  - type: regex
    value: "(?i)(ssh|scp|sftp)\\s+(-[a-zA-Z]\\s+)*-i\\s+[\"']?[^\\s]+\\.(pem|key|ppk)"
  - type: regex
    value: "(?i)(ssh|scp|sftp)\\s+(-[a-zA-Z]\\s+)*-i\\s+[\"']?~/?\\.(ssh|gnupg)/[^\\s]+"
examples:
  true_positive:
    - "ssh -i ~/.ssh/prod_key.pem user@server.com"
    - "scp -i mykey.pem file.txt user@host:/path"
  false_positive:
    - "ssh user@server.com"
    - "Generate an SSH key with ssh-keygen"
---
id: CRED_017
name: "Docker environment credentials"
description: "Detects Docker or docker-compose commands passing credentials via environment variables"
severity: MEDIUM
category: credential-leak
targets: ["*.md", "*.txt", "*.yaml", "*.yml"]
match_mode: any
patterns:
  - type: regex
    value: "(?i)(docker\\s+run|docker-compose|docker\\s+create)\\s+.{0,100}-e\\s+[\"']?[A-Z_]*(PASSWORD|SECRET|TOKEN|API_KEY|CREDENTIAL)[A-Z_]*\\s*="
  - type: regex
    value: "(?i)environment:\\s*\\n(\\s+-\\s+[A-Z_]*=.+\\n)*\\s+-\\s+[A-Z_]*(PASSWORD|SECRET|TOKEN|API_KEY|CREDENTIAL)[A-Z_]*\\s*="
examples:
  true_positive:
    - "docker run -e DATABASE_PASSWORD=mysecret123 myimage"
    - "docker run -e API_KEY=sk_live_abc123def456 myimage"
  false_positive:
    - "docker run -e NODE_ENV=production myimage"
    - "docker run -e PORT=3000 myimage"
