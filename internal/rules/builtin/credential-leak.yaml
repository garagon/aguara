id: CRED_001
name: "OpenAI API key"
description: "Detects OpenAI API keys"
severity: CRITICAL
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "sk-[a-zA-Z0-9]{20,}T3BlbkFJ[a-zA-Z0-9]{20,}"
  - type: regex
    value: "sk-proj-[a-zA-Z0-9_-]{40,}"
  - type: regex
    value: "sk-[a-zA-Z0-9]{48}"
examples:
  true_positive:
    - "OPENAI_API_KEY=sk-proj-abc123def456ghi789jkl012mno345pqr678stu901vwx"
  false_positive:
    - "Set your OPENAI_API_KEY=sk-your-key-here"
---
id: CRED_002
name: "AWS access key"
description: "Detects AWS access key IDs"
severity: CRITICAL
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "AKIA[0-9A-Z]{16}"
examples:
  true_positive:
    - "aws_access_key_id = AKIAIOSFODNN7EXAMPLE"
  false_positive:
    - "The format is AKIA followed by 16 characters"
---
id: CRED_003
name: "GitHub personal access token"
description: "Detects GitHub personal access tokens"
severity: CRITICAL
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "ghp_[a-zA-Z0-9]{36}"
  - type: regex
    value: "gho_[a-zA-Z0-9]{36}"
  - type: regex
    value: "ghu_[a-zA-Z0-9]{36}"
  - type: regex
    value: "ghs_[a-zA-Z0-9]{36}"
  - type: regex
    value: "ghr_[a-zA-Z0-9]{36}"
  - type: regex
    value: "github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59}"
examples:
  true_positive:
    - "GITHUB_TOKEN=ghp_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijkl"
  false_positive:
    - "Tokens start with ghp_ prefix"
---
id: CRED_004
name: "Generic API key pattern"
description: "Detects generic API key assignments with real-looking values"
severity: MEDIUM
category: credential-leak
targets: ["*.py", "*.js", "*.ts", "*.go", "*.java", "*.rb", "*.sh", "*.env", "*.yaml", "*.yml", "*.json"]
match_mode: any
patterns:
  - type: regex
    value: "(?i)(api[_-]?key|api[_-]?secret|apikey)\\s*[=:]\\s*[\"']?[a-zA-Z0-9_\\-]{32,}[\"']?"
  - type: regex
    value: "(?i)(access[_-]?token|auth[_-]?token)\\s*[=:]\\s*[\"']?[a-zA-Z0-9_\\-\\.]{32,}[\"']?"
examples:
  true_positive:
    - "API_KEY=abcdef1234567890abcdef1234567890ab"
    - "auth_token: eyJhbGciOiJIUzI1NiJ9.abcdefghijklmnop"
  false_positive:
    - "api_key = os.getenv('API_KEY')"
    - "api_key: your-api-key-here"
    - "API_KEY=sk-your-key-here"
---
id: CRED_005
name: "Private key block"
description: "Detects PEM-encoded private keys"
severity: CRITICAL
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "-----BEGIN\\s+(RSA|DSA|EC|OPENSSH|PGP)?\\s*PRIVATE KEY( BLOCK)?-----"
examples:
  true_positive:
    - "-----BEGIN RSA PRIVATE KEY-----"
    - "-----BEGIN OPENSSH PRIVATE KEY-----"
  false_positive:
    - "Look for files that start with the BEGIN header"
---
id: CRED_006
name: "Database connection string"
description: "Detects database connection strings with credentials"
severity: HIGH
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "(?i)(mongodb|postgres|postgresql|mysql|redis|amqp|mssql)://[a-zA-Z0-9_]+:[a-zA-Z0-9_!@#$%^&*]+@[a-zA-Z0-9]+\\.[a-zA-Z0-9._\\-]+[:/]"
  - type: regex
    value: "(?i)Data Source=.*;.*Password=.+"
examples:
  true_positive:
    - "DATABASE_URL=postgres://admin:secretpass@db.example.com:5432/mydb"
    - "mongodb://root:password123@mongo.example.com/admin"
  false_positive:
    - "postgres://user:password@localhost/dev"
---
id: CRED_007
name: "Hardcoded password"
description: "Detects hardcoded passwords in code"
severity: HIGH
category: credential-leak
targets: ["*.py", "*.js", "*.ts", "*.go", "*.java", "*.rb", "*.sh"]
match_mode: any
patterns:
  - type: regex
    value: "(?i)(password|passwd|pwd)\\s*[=:]\\s*[\"'][^\"'\\s]{8,}[\"']"
  - type: regex
    value: "(?i)(password|passwd|pwd)\\s*=\\s*[\"'][^\"']{8,}[\"']"
examples:
  true_positive:
    - "password = 'supersecret123'"
    - "DB_PASSWORD=\"MyS3cretP@ss\""
  false_positive:
    - "password = os.getenv('DB_PASSWORD')"
    - "password = input('Enter password: ')"
---
id: CRED_008
name: "Slack or Discord webhook"
description: "Detects Slack and Discord webhook URLs"
severity: HIGH
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "https://hooks\\.slack\\.com/services/T[A-Z0-9]+/B[A-Z0-9]+/[a-zA-Z0-9]+"
  - type: regex
    value: "https://(discord|discordapp)\\.com/api/webhooks/[0-9]+/[a-zA-Z0-9_-]+"
examples:
  true_positive:
    - "SLACK_WEBHOOK=https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX"
    - "https://discord.com/api/webhooks/123456789/abcdef"
  false_positive:
    - "Set up Slack webhooks at hooks.slack.com"
---
id: CRED_009
name: "GCP service account key"
description: "Detects Google Cloud Platform service account credentials"
severity: CRITICAL
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "\"type\"\\s*:\\s*\"service_account\""
  - type: regex
    value: "\"private_key\"\\s*:\\s*\"-----BEGIN"
examples:
  true_positive:
    - '{"type": "service_account", "project_id": "my-project"}'
  false_positive:
    - "Account type can be service_account or user"
---
id: CRED_010
name: "JWT token"
description: "Detects JWT tokens"
severity: MEDIUM
category: credential-leak
targets: []
match_mode: any
patterns:
  - type: regex
    value: "eyJ[a-zA-Z0-9_-]{10,}\\.eyJ[a-zA-Z0-9_-]{10,}\\.[a-zA-Z0-9_-]{10,}"
examples:
  true_positive:
    - "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIn0.dozjgNryP4J3jVmNHl0w5N_XgL0n3I9PlFUP0THsR8U"
  false_positive:
    - "JWT tokens follow the format: header.payload.signature"
---
id: CRED_011
name: "Credential in shell export"
description: "Detects API keys or tokens exposed in shell export commands"
severity: HIGH
category: credential-leak
targets: ["*.md", "*.txt"]
match_mode: any
patterns:
  - type: regex
    value: "(?i)export\\s+[A-Z_]*(API[_-]?KEY|SECRET|TOKEN|PASSWORD|CREDENTIAL)[A-Z_]*\\s*=\\s*[\"']?(sk-|ghp_|gho_|AKIA|xox[bpas]-|glpat-|pypi-)[a-zA-Z0-9_\\-]{20,}"
  - type: regex
    value: "(?i)export\\s+[A-Z_]*(API[_-]?KEY|SECRET|TOKEN)[A-Z_]*\\s*=\\s*[\"'][a-zA-Z0-9_\\-]{30,}[\"']"
examples:
  true_positive:
    - "export OPENROUTER_API_KEY=\"sk-or-v1-abc123def456ghi789jkl012mno345pqr678\""
    - "export GITHUB_TOKEN=\"ghp_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijkl\""
  false_positive:
    - "export OPENROUTER_API_KEY=\"sk-or-v1-...\""
    - "export API_KEY=\"your-key-here\""
